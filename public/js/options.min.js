var app = new Vue({
    el: '#app',
    data: {
        data: {}
    }
});
$(document).ready(function () {
    /* handle tables */
    // var idwork = $('#work').val();
    // alert(idwork);
    var table = $('#options-table').DataTable({

        responsive: true,
        "scrollX": true,
        processing: true,
        serverSide: true,
        ajax: APP_URL + '/options/datatables/',
        
        columns: [

            {
                data: "options_id",

                render: function (data, type, row, meta) {
                    var number = meta.row + meta.settings._iDisplayStart + 1
                    var btnView = '<a href="/options/data/' + data + '"  title="รายละเอียด">' + number+'</a> ';
                    return btnView;
                },
            },
            {
                data: 'oname',
                name: 'oname',
                className: "text-left",
                render: function (data, type, row) {
    
                    var btnView = '<a href="/options/data/' + row['options_id'] + '"  title="รายละเอียด">' + data + '</a> ';
                    return btnView;
                },
            },
            {
                data: 'garuntee',
                name: 'garuntee',
                render: function (data, type, row) {

                    var btnView = '<a href="/options/data/' + row['options_id'] + '"  title="รายละเอียด">' + data + '</a> ';
                    return btnView;
                },
            },
            {
                data: 'workname',
                name: 'workname',
                render: function (data, type, row) {

                    var btnView = '<a href="/options/data/' + row['options_id'] + '"  title="รายละเอียด">' + data + '</a> ';
                    return btnView;
                },
            },
            {
                data: 'options_id',
                name: 'options_id'
            },{

                data: 'id',
                orderable: false,
                render: function (data, type, row) {
                    textdata = '';
                    return textdata;
                },
            }
        ],

        columnDefs: [{
            targets: 4,
            orderable: false,
            render: function (data, type, row) {
                var dataName = row['oname'];
                var btnEdit = '<a href="/options/form/' + data + '"  class="btn btn-outline-dark btn-sm" title="แก้ไข"><i class="fa fa-edit"></i></a> ';
                var btnDelete = '<a href="#" data-href="' + APP_URL + '/options/' + data + '" data-id="' + data + '" data-name="' + dataName + '" role="button" class="btn btn-outline-danger btn-sm btn-delete" title="ลบ"><i class="fa fa-trash"></i></a>';
                // var btnView = '<a href="#" data-href="' + APP_URL + '/user/view/' + row.id + '" data-modal-name="ajaxModal" data-id="' + row.id + '" class="btn-edit">' + data + '</a> ';
                btnDelete = APP_USERID != data ? btnDelete : '';
                return btnEdit + btnDelete;
            },
        }]
    });
    /* handle tables */

    /* handle validate */
    // $('#saveForm').on('shown.bs.modal', function (e) {
    //     $('#saveForm').validate({
    //         submitHandler: function (form) {
    //             var id = $('input[name=id]').val();
    //             var url = APP_URL + '/work';
    //             saveForm(id, url, table);
    //         },
    //         rules: {
    //             workname: {
    //                 required: true
    //             }
    //         },

    //         errorElement: 'span',
    //         errorPlacement: function (error, element) {
    //             error.addClass("error-block");
    //             error.addClass("invalid-feedback");
    //             if (element.prop("type") === "checkbox") {
    //                 error.insertAfter(element.parent("label"));
    //             } else if (element.parent('.input-group').length) {
    //                 error.insertAfter(element.parent()); /* radio checkbox? */
    //             } else if (element.hasClass('select2')) {
    //                 error.insertAfter(element.next('span')); /* select2 */
    //             } else {
    //                 error.insertAfter(element);
    //             }
    //         },
    //         highlight: function (element, errorClass, validClass) {
    //             $(element).parents('.form-group').addClass('has-error').removeClass('has-success');
    //             $(element).addClass('is-invalid').removeClass('is-valid');
    //         },
    //         unhighlight: function (element, errorClass, validClass) {
    //             $(element).parents('.form-group').addClass('has-success').removeClass('has-error');
    //             $(element).addClass('is-valid').removeClass('is-invalid');
    //         }
    //     });
    // });



    //สร้างปุ่มใน Datatable
    /* handle delete */
    $('body').on('click', '.btn-delete', function (e) {
        e.preventDefault();
        var url = $(this).data('href');
        var name = $(this).data('name');
        var callback = function () {
            deleteForm(url, table);
        }

        confirmBox('ลบข้อมูล ' + name, callback);
    });
});
